---
title: "Gentrified Boston - SML Methods"
author: "Rebecca Brent"
output: html_notebook
---
```{r, warning=FALSE, message=FALSE}
#Libraries required
library(tidyverse)
library(caret)
library(nnet)
library(MASS)
```



```{r, message=F,warning=F}
#load data from github
suffolk_df<- read_csv("https://raw.githubusercontent.com/erinkeough/DS5500-fall2020-rb-bc-ek-rm/master/census-csv/prop_change_suffolk_labeled.csv")

suffolk_df<-read_csv("census-csv/prop_change_suffolk_labeled.csv")

```

```{r}
#Create Train-Test Split  
set.seed(1)
trainIndex <- createDataPartition(suffolk_df$Gent_Label, p = .8,
                                  list = FALSE,
                                  times = 1)
imbal_train <- suffolk_df[trainIndex,]
imbal_valid <- suffolk_df[-trainIndex,]

# Resample the train data to account for class imbalance
#ctrl <- trainControl(method = "repeatedcv", repeats = 5,
#                     classProbs = TRUE,
#                     summaryFunction = twoClassSummary,
#                     sampling = "rose")
#set.seed(1)
#rose_inside <- train(Gent_Label~ .-Census.Tract.Code, 
#                     data = imbal_train,
#                     method = "glm",
#                     family="binomial",
#                     metric = "ROC",
#                     trControl = ctrl)
#inside_resampling <- resamples(rose_inside)
#y_pred <- predict(rose_inside, data=imbal_valid)
#calc_acc(actual = default_tst$default,
#         predicted = predict(default_glm_mod, newdata = default_tst))
```


## Linear Discriminant Analysis

### Fit with all predictors

```{r}
lda_cvfit<-lda(Gent_Label~.-Census.Tract.Code, data = suffolk_df, cv=T)
lda_cvpred<-predict(lda_cvfit, suffolk_df)
mean(lda_cvpred$class==suffolk_df$Gent_Label)
```
Accuracy 


### Fit with intuitive subset

Chosen by examining PCA and inuition

```{r}
suff_intu<-suffolk_df%>%dplyr::select(prop.change.population.young.adult,
                               prop.change.population.race.White,
                               prop.change.housing.householder.race.White,
                               prop.change.household.size,
                               Gent_Label)

lda_intu<-lda(Gent_Label~., data = suff_intu, cv=T)
lda_pred_intu<-predict(lda_intu, suffolk_df)
mean(lda_pred_intu$class==suffolk_df$Gent_Label)

```



```{r}

rf_fit<-randomForest(Gent_Label~., data=suff_numeric)
```


```{r}
#Run multinomial logistic regression
multinomModel <- multinom(Gent_Label~.-Census.Tract.Code, data = imbal_train)
summary(multinomModel)
```

