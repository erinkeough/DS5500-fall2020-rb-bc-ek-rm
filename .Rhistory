require(tidyverse)
require(tidycensus)
require(tmap)
?census_api_key
readRenviron("~/.Renviron")
require(tidyverse)
require(tidycensus)
getwd()
bos90<-read_csv("census-csv/bos_90.csv")
bos00<-read_csv("census-csv/bos_2000.csv")
bos10<-read_csv("census-csv/bos_2010.csv")
View(bos00)
class(bos00$tract)
bos00<-bos00%>%
mutate(GEOID = str_pad(as.character(tract),width = 6, side = "right", pad ="0"))%>%
select(-tract)
write_csv(bostract00, "bos_2000.csv")
write_csv(bos00, "bos_2000.csv")
View(bos10)
View(bos90)
##     2000 Census data by Tract of Suffolk county MA (Boston, ma)
##
## Scraping from FFIEC website (both pages)
bos001<-read_html("https://www.ffiec.gov/census/report.aspx?year=2000&county=025&tract=ALL&state=25&report=demographic")%>%
html_node("form table")%>%
html_table()
require(rvest)
##     2000 Census data by Tract of Suffolk county MA (Boston, ma)
##
## Scraping from FFIEC website (both pages)
bos001<-read_html("https://www.ffiec.gov/census/report.aspx?year=2000&county=025&tract=ALL&state=25&report=demographic")%>%
html_node("form table")%>%
html_table()
bos002<-read_html("https://www.ffiec.gov/census/report.aspx?year=2000&county=025&tract=ALL&state=25&report=demographic&page=2")%>%
html_node("form table")%>%
html_table()
bostract00<-rbind(bos001, bos002)
### Clean up names and
bostract00<-bostract00%>%
rename(tract = `Tract Code`, med_income00 = `2000 Est. Tract/ BNA Median Family Income`,
med_income90 = `1990 Tract/ BNA Median Family Income`, tot_pop = `Tract/ BNA Population`,
nonwhite_pop = `Minority Population`, owner_occ = `Owner Occupied Units`)%>%
select(tract, med_income00, med_income90, tot_pop, nonwhite_pop, owner_occ)
rm(bos00)
View(bostract00)
rm(bos001, bos002)
bos00<-bostract00%>%
mutate(GEOID = str_remove_all(tract, "\\."),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 6, pad = "0"))
View(bos00)
View(bostract00)
class(bostract00$tract)
bos00<-bostract00%>%
mutate(GEOID = str_remove_all(as.character(tract), "\\."),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 6, pad = "0"))
as.character(bostract00$tract)
bos00<-bostract00%>%
mutate(GEOID = str_remove_all(as.character(tract), "\\."),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 3, side="right",pad = "0"))%>%
mutate(GEOID = str_pad(GEOID, width = 6, pad = "0"))
View(bos00)
bos00<-bostract00%>%
mutate(GEOID = ifelse(str_detect(as.character(tract), "\\."), as.character(tract), paste0(as.character(tract),".00")),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))
bos00<-bostract00%>%
mutate(GEOID = ifelse(str_detect(as.character(tract), "\\."), as.character(tract), paste0(as.character(tract),".00")),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 6, pad = "0"))
bos00<-bostract00%>%
mutate(GEOID = ifelse(str_detect(as.character(tract), "\\."), as.character(tract), paste0(as.character(tract),".00")),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 6, pad = "0"))%>%
mutate(GEOID = str_remove(GEOID, "\\."))
bos00<-bostract00%>%
mutate(GEOID = ifelse(str_detect(as.character(tract), "\\."), as.character(tract), paste0(as.character(tract),".00")),
med_income00 = str_remove_all(med_income00, "[\\$\\,]"),
med_income90 = str_remove_all(med_income90, "[\\$\\,]"))%>%
mutate(GEOID = str_pad(GEOID, width = 7, pad = "0"))%>%
mutate(GEOID = str_remove(GEOID, "\\."))
write_csv(bos00, "bos_2000.csv")
rm(bostract00)
bos_acs10<-bos_acs10%>%
select(-NAME)%>%
left_join(bos_acs10_pop, by = "GEOID")%>%
mutate(adjMHI = DP03_0062E*1.0935,
percEng = DP02_0111PE,
percWhite = 100*DP05_0032E/B01001_001E)%>%
mutate(GEOID = str_remove(bos_acs10$GEOID, "25025"))%>%
filter(bos_acs10, str_detect(GEOID, "^9"))
bos_acs10<-bos_acs10%>%
select(-NAME)%>%
left_join(bos_acs10_pop, by = "GEOID")%>%
mutate(adjMHI = DP03_0062E*1.0935,
percEng = DP02_0111PE,
percWhite = 100*DP05_0032E/B01001_001E)%>%
mutate(GEOID = str_remove(bos_acs10$GEOID, "25025"))%>%
filter(bos10, str_detect(GEOID, "^9"))
filter(bos10, str_detect(GEOID, "^9"))
filter(bos10, !str_detect(GEOID, "^9"))
bos10<-filter(bos10, !str_detect(GEOID, "^9"))
View(bos10)
comp<-tibble(yr00 = sort(bos00$GEOID), yr10 = sort(bos10$GEOID))%>%mutate(same = (yr00==yr10))
comp<-tibble(yr00 = sort(c(bos00$GEOID, "000000")), yr10 = sort(bos10$GEOID))%>%mutate(same = (yr00==yr10))
View(comp)
comp<-tibble(yr00 = sort(c(bos00$GEOID, "990000")), yr10 = sort(bos10$GEOID))%>%mutate(same = (yr00==yr10))
tract90<-read_csv("bos_90.csv")
tract90<-read_csv("census-csv/bos_90.csv")
View(tract90)
rm(comp)
